package dbaccess

import (
	_ "github.com/go-sql-driver/mysql"
	"github.com/jmoiron/sqlx"
	"schemagenerator.com/db"
	"schemagenerator.com/gmodels"
)

var conntions map[string]*sqlx.DB

func init() {
	conntions = make(map[string]*sqlx.DB)
}

func getDbEngine(conn string) (error, *sqlx.DB) {
	var sqlxDB *sqlx.DB
	val, ok := conntions[conn]
	if ok {
		sqlxDB = val
	} else {
		database, err := sqlx.Connect("mysql", conn)
		if err != nil {
			return err, nil
		}
		conntions[conn] = database
		sqlxDB = database
	}
	return nil, sqlxDB
}

$$funcs$$